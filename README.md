# Космический Телеграм

Программа предназначена для получения тематических фотографий из сервисов Nasa и SpaceX и их дальнейшего размещения в телеграм канале посредством бота

Состоит из следующих скриптов:

1. fetch_spacex_images.py - скачивает фото запуска SpaceX по id
2. fetch_spacex_launch_id.py - получает список id запусков SpaceX
3. fetch_nasa_apod.py - скачивает тематические фотографии с сайта NASA
4. fetch_nasa_epic.py - скачивает фотографии Земли с сайта NASA
5. tg_loop_photo_publisher_bot.py - размещает фотографии в телеграм канале в бесконечном цикле
6. tg_photo_publisher_bot.py - размещает указанную фотографию в телеграм канале

### Как установить

Python3 должен быть уже установлен.

Затем используйте `pip` (или `pip3`, есть есть конфликт с Python2) для установки зависимостей:
```
pip install -r requirements.txt
```
Для доступа к API NASA необходимо получить токен на [сайте NASA](https://api.nasa.gov/)

Для работы с телеграм каналом необходимо зарегистрировать бота через [BotFather](https://t.me/BotFather) и назначить его администратором вашего канала.

Также требуется определить chat_id вашего канала. Как это сделать можете почитать на странице [обсужения](https://qna.habr.com/q/478104) на habr.com

Переименуйте файл `.env.example` в `.env` и занесите в него полученные токены и id

```
NASA_API_TOKEN=[your_nasa_api_token]
TELEGRAM_BOT_TOKEN=[your_telegram_bot_token]
TELEGRAM_CHANNEL_ID=[your_channel_id]
```
При запуске скриптов, предназначенных для скачивания или публикации фотографий необходимо передать в качестве аргумента путь к папке загрузки/публикации:
```
python fetch_spacex_images.py /images
```
Можно передать как абсолютный, так и относительный пути.

Если указанной директории для скачивания не существует, она будет создана.

### Как скачивать фотографии

1. Запустие fetch_spacex_images.py и передайте в качестве аргумента id запуска через флаг -l или --launch:
```
python fetch_spacex_images.py -l 5eb87cedffd86e000604b340
```

При запуске без аргументов
```
python fetch_spacex_images.py
```
загружается фото с последнего запуска.

Для того чтобы получить списов id запусков откройте `fetch_spacex_launch_id.py`

Скрипт сохранит id по всем запускам в файле `spacex_id.txt`

Не все запуски имеют фото, если фото не скачалось, попробуйте задать другое id

2. Запустите `fetch_nasa_apod.py`
```
python fetch_nasa_apod.py
```

3. Заустите fetch_nasa_epic.py
```
python fetch_nasa_epic.py
```

### Как разместить фотографии на канале

1. Для рамещения фотографий в бесконечном цикле запустите `tg_loop_photo_publisher_bot.py`
```
python tg_loop_photo_publisher_bot.py
```
Задержка между постами по умолчанию - 4 часа.

Для того чтобы установить другое время задержки передайте его в качестве параметра через флаг -d или --delay.

Время задается в часах (можно задать число с плавающей точкой):
```
python tg_loop_photo_publisher_bot.py 0.5
```
Фотографии будут размещены с задержкой в полчаса.

2. Для размещения одной фотографии запустите `tg_photo_publisher_bot.py` передав имя файла после флага -f или --file 

```
python tg_loop_photo_publisher_bot.py spacex_0.png
```

При запуске без параметров будет размещена случайная фотография из указанной директории

### Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).
